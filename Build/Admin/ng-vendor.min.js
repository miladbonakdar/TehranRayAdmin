/*
 sepanta 2017-04-26 
*/
var appName="adminApp",uploadURL="../api/upload/",serviceBaseURL="../api/admin/",debugMode=!1,app=angular.module(appName,["ngRoute","treasure-overlay-spinner","ui.router","angular-confirm","oc.lazyLoad","ngAnimate","toaster","ui.bootstrap","ui.router.title","ui.select","ngPersian","ngFileUpload","anim-in-out","am-charts","ADM-dateTimePicker","ngSanitize","ngCookies","textAngular"]);app.config(["$provide","$stateProvider","$urlRouterProvider","$ocLazyLoadProvider","ADMdtpProvider",function(a,b,c,d,e){d.config({debug:debugMode,events:!0}),e.setOptions({calType:"jalali",format:"YYYY/MM/DD hh:mm"}),b.state("dashboard",{url:"/dashboard",templateUrl:"angular.partial.Dashboard.html",controller:"DashboardCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"داشبورد"}}}).state("profile",{url:"/profile/:action",templateUrl:"angular.partial.Profile.html",controller:"ProfileCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"پروفایل"}}}).state("reporting",{url:"/reporting",templateUrl:"angular.partial.Reporting.html",controller:"ReportingCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"گزارش گیری"}}}).state("stone",{url:"/stone",templateUrl:"angular.partial.AllStone.html",controller:"AllStoneCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"لیست سنگ ها"}}}).state("stone_page",{url:"/stonePage/:id",templateUrl:"angular.partial.Stone.html",controller:"StoneCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"مشاهده سنگ"}}}).state("stone_types",{url:"/stoneTypes",templateUrl:"angular.partial.StoneTypes.html",controller:"StoneTypesCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"مدیریت انواع سنگ"}}}).state("user",{url:"/user/:id",templateUrl:"angular.partial.User.html",controller:"UserCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"مدیریت اعضا"}}}).state("phone",{url:"/phone",templateUrl:"angular.partial.Phone.html",controller:"PhoneCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"مدیریت گوشی ها"}}}).state("stone_edit",{url:"/StoneEdit/:id",templateUrl:"angular.partial.StoneEdit.html",controller:"StoneEditCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"ویرایض سنگ"}}}).state("cope",{url:"/Cope",templateUrl:"angular.partial.Cope.html",controller:"CopeCtrl",resolve:{deps:["$ocLazyLoad",function(a){return a.load([])}],$title:function(){return"مدیریت سنگ های خام"}}}),a.decorator("taOptions",["taRegisterTool","$uibModal","$delegate",function(a,b,c){return c.toolbar=[["h1","h4","h6","p","pre","quote"],["html","customInsertImage","insertLink","wordcount","charcount"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight"],["dirLtr","dirRtl"]],a("dirLtr",{iconclass:"fa fa-indent",action:function(){return this.$editor().wrapSelection("formatBlock",'<P style="direction:ltr">')}}),a("dirRtl",{iconclass:"fa fa-dedent",action:function(){return this.$editor().wrapSelection("formatBlock",'<P style="direction:rtl">')}}),a("customInsertImage",{iconclass:"fa fa-picture-o",action:function(a){var c=this,d=rangy.saveSelection(),e=b.open({templateUrl:"../js/text-angular/CustomSelectImageModal.tmpl.html",size:"md",controller:["$uibModalInstance","$scope","Upload","$state",function(a,b,c,d){b.activeTab=0,b.img={url:""},b.submit=function(){a.close(b.img.url)},b.cancel=function(){a.close()},b.getTab=function(a){b.activeTab=a},b.addImageLink=function(b){a.close(b)},b.filesChanged=function(b,e){var f=uploadURL;f+="upload_inline_attachment.php";var g={file:e};g.Type=d.current.name,e.uploader=c.upload({url:f,data:g}),e.uploader.then(function(b){a.close(b.data),console.log("Success "+b.config.data.file.name+"uploaded. Response: "+b.data)},function(a){console.log("Error status: "+a.status)},function(a){var b=parseInt(100*a.loaded/a.total);a.config.data.file.percent=b})},b.stopUploadImage=function(a){a.uploader.abort()}}]});return e.result.then(function(b){if(b){rangy.restoreSelection(d);var e='<a href="'+b+'" target="_blank"><img class="img-responsive link attachment-inline-img"  src="'+b+'"  /></a>';c.$editor().wrapSelection("insertHtml",e),a.resolve()}}),!1}}),c}]),c.otherwise(function(a,b){var c=a.get("$state");c.go("dashboard")})}]);var persian={0:"۰",1:"۱",2:"۲",3:"۳",4:"۴",5:"۵",6:"۶",7:"۷",8:"۸",9:"۹"},traverse=function(a){if(3==a.nodeType){var b=a.data.match(/[0-9]/g);if(null!=b&&0!=b.length)for(var c=0;c<b.length;c++)a.data=a.data.replace(b[c],persian[b[c]])}for(var c=0;c<a.childNodes.length;c++)traverse(a.childNodes[c])},fixPersianNumbers=function(){traverse(document.body)},fixFooter=function(){traverse(document.body)},activeElement=function(a,b){if(b){var c=$(b);c.addClass("active").siblings().removeClass("active")}var d=$(a);d.addClass("active").siblings().removeClass("active")},cmsVars={},hideCMS=function(a){a?(cmsVars.v1=$(".content-wrapper").css("marginRight"),cmsVars.v2=$(".main-footer").css("marginRight"),cmsVars.v3=$(".main-header").css("display"),cmsVars.v4=$(".main-sidebar").css("display"),$(".content-wrapper").css("margin-right","0"),$(".main-footer").css("margin-right","0"),$(".main-header").css("display","none"),$(".main-sidebar").css("display","none")):($(".content-wrapper").css("margin-right",cmsVars.v1),$(".main-footer").css("margin-right",cmsVars.v2),$(".main-header").css("display",cmsVars.v3),$(".main-sidebar").css("display",cmsVars.v4))};app.factory("Extention",["$http","$timeout","$rootScope","$state","$stateParams","toaster","$uibModal",function(a,b,c,d,e,f,g){c.logout=function(){h.post("logout").then(function(a){a&&"success"==a.Status?window.location="../":h.popError("مشکل ، لطفا دوباره امتحان کنید.")})},c.user=session,c.spinner={};var h={};return h.workers=0,h.serviceBase=serviceBaseURL,h.debugMode=debugMode,h.noImageClass="fa fa-2x fa-user",h.setBusy=function(a){a?(0===h.workers&&(c.spinner.active=!0),h.workers++):(h.workers--,0===h.workers&&b(h.disableLoading,500))},h.toast=function(a){f.pop(a.status,"",a.message,1e4,"trustedHtml")},h.pop=function(a,b,c){c||(c=7e3),f.pop(a,"",b,c,"trustedHtml")},h.popError=function(a,b){b||(b=7e3),f.pop("error","",a,b,"trustedHtml")},h.popSuccess=function(a,b){b||(b=7e3),f.pop("success","",a,b,"trustedHtml")},h.popInfo=function(a,b){b||(b=7e3),f.pop("info","",a,b,"trustedHtml")},h.get=function(b){return h.setBusy(!0),a.get(h.serviceBase+b).then(function(a){return h.setBusy(!1),a.data},function(a){return h.setBusy(!1),a})},h.getExternal=function(b){return h.setBusy(!0),a.get(b).then(function(a){return h.setBusy(!1),a.data},function(a){return h.setBusy(!1),a})},h.post=function(b,c){return h.setBusy(!0),a.post(h.serviceBase+b,c).then(function(a){return h.debugMode&&(console.log(a.data),200!=a.status&&h.popModal(a)),h.setBusy(!1),a.data.AuthState&&"UN_AUTH"==a.data.AuthState&&(console.log("State : UN_AUTHORIZED_USER"),window.location="../"),a.data},function(a){return h.debugMode&&(console.log(a.data),h.popModal(a.data)),a.data.AuthState&&"UN_AUTH"==a.data.AuthState&&(console.log("State : UN_AUTHORIZED_USER"),window.location="../"),h.setBusy(!1),a})},h.postAsync=function(b,c){return a.post(h.serviceBase+b,c).then(function(a){return h.debugMode&&200!=a.status&&h.popModal(a),a.data},function(a){return h.debugMode&&h.popModal(a.data),a})},h.disableLoading=function(){c.spinner.active=!1},h.authUser=function(a){c.authenticated=!0,c.user={},c.user.UserID=a.UserID,c.user.lastName=a.LastName,c.user.firstName=a.FirstName},h.unAuthUser=function(){c.authenticated=!1,c.isAdmin=!1,c.user={}},h.isAdmin=function(){return c.isAdmin},h.getAuth=function(){return{authenticated:c.authenticated,isAdmin:c.isAdmin}},h.openSignupPanel=function(a){var b;b="en"==a?"partials/HomeEN/SignupTemplate.html":"partials/Home/SignupTemplate.html",g.open({animation:!0,templateUrl:b,controller:"authCtrl",size:"md"})},h.openSigninPanel=function(a){var b;b="en"==a?"partials/HomeEN/LoginTemplate.html":"partials/Home/LoginTemplate.html",g.open({animation:!0,templateUrl:b,controller:"authCtrl",size:"md"})},h.scrollTo=function(a){function b(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}var c=b(),d=a,e=d>c?d-c:c-d;if(e<100)return void scrollTo(0,d);var f=Math.round(e/10);f>=5&&(f=5);var g=Math.round(e/25),h=d>c?c+g:c-g,i=0;if(d>c)for(var j=c;j<d;j+=g)setTimeout("window.scrollTo(0, "+h+")",i*f),h+=g,h>d&&(h=d),i++;else for(var j=c;j>d;j-=g)setTimeout("window.scrollTo(0, "+h+")",i*f),h-=g,h<d&&(h=d),i++},h.scrollToElement=function(a,b){function c(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function d(a){for(var b=document.getElementById(a),c=b.offsetTop,d=b;d.offsetParent&&d.offsetParent!=document.body;)d=d.offsetParent,c+=d.offsetTop;return c}b||(b=0);var e=c(),f=d(a)+b,g=f>e?f-e:e-f;if(g<100)return void scrollTo(0,f);var h=Math.round(g/10);h>=5&&(h=5);var i=Math.round(g/25),j=f>e?e+i:e-i,k=0;if(f>e)for(var l=e;l<f;l+=i)setTimeout("window.scrollTo(0, "+j+")",k*h),j+=i,j>f&&(j=f),k++;else for(var l=e;l>f;l-=i)setTimeout("window.scrollTo(0, "+j+")",k*h),j-=i,j<f&&(j=f),k++},h}]),app.factory("OnlineSocket",["$http","$timeout","$rootScope","Extention",function(a,b,c,d){var e={};return e.getData=function(){b(function(){e.fetch()},5e4)},e.fetch=function(){d.postAsync("getSocketData").then(function(a){c.socketData=a,b(function(){c.$broadcast("socketDataChanged")}),e.getData()})},e.fetch(),e}]),app.directive("errSrc",function(){return{link:function(a,b,c){b.bind("error",function(){c.src!=c.errSrc&&c.$set("src",c.errSrc)})}}}),app.run(["$rootScope","$templateCache","$state","$location","Extention","OnlineSocket",function(a,b,c,d,e,f){a.spinner={},a.$on("$stateChangeSuccess",function(){e.setBusy(!1)}),a.$on("$stateChangeError",function(a,b,c,d,f,g){e.setBusy(!1)}),a.$on("$stateNotFound",function(a,b,c,d){e.setBusy(!1)}),a.$on("$stateChangeStart",function(b,c,d){e.setBusy(!0),a.globalSearchActive=!1})}]),app.filter("fileSizeFilter",function(){return function(a,b){if(isNaN(parseFloat(a))||!isFinite(a))return"-";"undefined"==typeof b&&(b=1);var c=["بایت","کیلوبایت","مگابایت","گیگابایت","ترابایت","پتابایت"],d=Math.floor(Math.log(a)/Math.log(1024));return persianJs((a/Math.pow(1024,Math.floor(d))).toFixed(b)).englishNumber().toString()+" "+c[d]}}),app.filter("fileSizeFilterEnglish",function(){return function(a,b){if(isNaN(parseFloat(a))||!isFinite(a))return"-";"undefined"==typeof b&&(b=1);var c=["B","KB","MB","GB","TB","PT"],d=Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,Math.floor(d))).toFixed(b)+" "+c[d]}}),app.filter("jalaliDate",function(){return function(a,b){var c=moment(a);return c.fromNow()+" "+c.format(b)}}),app.filter("jalaliDateSimple",function(){return function(a,b){var c=moment(a);return c.format(b)}}),app.filter("moment",function(){return function(a,b){return moment(a).format(b)}}),app.filter("subString",function(){return function(a,b){return a&&a.length>b?a.substr(0,b)+"...":a}}),app.filter("fromNow",function(){return function(a){var b=moment(a);return b.fromNow()}}),app.filter("split",function(){return function(a,b,c){if(!a)return"";for(var d="",e=0;e<a.length;e++)d+=e===a.length-1?a[e][c]:a[e][c]+b;return d}}),app.filter("Length",function(){return function(a){var b=Number(a);return b/=10,b.toString()+" سانتی متر"}}),app.filter("Volume",function(){return function(a){var b=Number(a);return b/=1e6,b.toString()+" متر مربع"}}),app.filter("Weight",function(){return function(a){if(a.length>3){var b=Number(a);return b/=1e3,b.toString()+" تن"}return a+" تن"}}),app.filter("Toman",function(){return function(a){return a+"  هزار تومان"}}),app.filter("Time",function(){return function(a){var b=new Date(a);return b.getHours()+":"+b.getMinutes()}}),app.directive("slideable",function(){return{restrict:"C",compile:function(a,b){var c=a.html();return a.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+c+"</div>"),function(a,b,c){c.duration=c.duration?c.duration:"1s",c.easing=c.easing?c.easing:"ease-in-out",b.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:c.duration,transitionTimingFunction:c.easing})}}}}),app.directive("slideToggle",function(){return{restrict:"A",link:function(a,b,c){var d=document.querySelector(c.slideToggle);c.expanded=!1,b.bind("click",function(){var a=d.querySelector(".slideable_content");if(c.expanded)d.style.height="0px";else{a.style.border="1px solid rgba(0,0,0,0)";var b=a.clientHeight;a.style.border=0,d.style.height=b+"px"}c.expanded=!c.expanded})}}}),app.directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}]),angular.module("ui.router.title",["ui.router"]).run(["$rootScope","$timeout","$state","Extention",function(a,b,c,d){function e(a){return angular.isFunction(a)?a():a}a.$on("$stateChangeSuccess",function(){var f=c.$current.locals.globals.$title,g=c.$current.locals.globals.$isAsyncTitle;if(g)d.post(f).then(function(d){b(function(){a.$title=d.SiteName}),a.$breadcrumbs=[];for(var f=c.$current;f;)f.resolve&&f.resolve.$title&&a.$breadcrumbs.unshift({title:e(f.locals.globals.$title),state:f.self.name,stateParams:f.locals.globals.$stateParams}),f=f.parent});else{var h=e(f);b(function(){a.$title=h}),a.$breadcrumbs=[];for(var i=c.$current;i;)i.resolve&&i.resolve.$title&&a.$breadcrumbs.unshift({title:e(i.locals.globals.$title),state:i.self.name,stateParams:i.locals.globals.$stateParams}),i=i.parent}})}]),angular.module(appName).controller("AdminCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","$log",function(a,b,c,d,e,f,g){}]),angular.module(appName).controller("AllStoneCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","Extention",function(a,b,c,d,e,f,g){a.pagingParams={},a.pagingController={},console.log(b.user.AdminPermissionLevel),a.search=function(){a.pagingController.update()},a.removeStone=function(b){g.post("deleteStone",{StoneID:b}).then(function(b){b&&"success"==b.Status?(g.popSuccess("سنگ با موفقیت حذف شد!"),a.pagingController.update()):g.popError("مشکل در حذف سنگ ، لطفا دوباره امتحان کنید.")})},activeElement("#SStone")}]),angular.module(appName).controller("CopeCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","Extention","$uibModal",function(a,b,c,d,e,f,g,h){a.pagingParams={},a.pagingController={},a.cope={},a.StoneType={selected:null},a.StoneTypes=[],g.postAsync("getAllStoneTypes",{}).then(function(b){a.StoneTypes=b.Data}),a.search=function(){a.pagingController.update()},a.editCope=function(b){a.cope=b;for(var c=0;c<a.StoneTypes.length;c++)if(a.StoneTypes[c].StoneTypeID==b.StoneTypeID){a.StoneType.selected=a.StoneTypes[c];break}},a.cancleEdite=function(){a.cope={},a.StoneType.selected=null},a.insertNewUser=function(){return!a.user.FullName||a.user.FullName.length<3?void g.popError("نام کامل وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.Email||a.user.Email.length<3?void g.popError("ایمیل وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.Username||a.user.Username.length<3?void g.popError("نام کاربری وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.pass||a.user.pass.length<3?void g.popError("پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.passRe||a.user.passRe.length<3?void g.popError("تکرار پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):a.UserType.selected?a.user.passRe!=a.user.pass?void g.popError("پسورد با تکرار آن برابر نیست"):(a.user.PermissionID=a.UserType.selected.AdminPermissionID,void g.post("savePerson",a.user).then(function(b){console.log(b),b&&"success"==b.Status?(g.popSuccess(b.Data),a.user={},a.pagingController.update()):g.popError(b.Message)})):void g.popError("نوع کاربر را انتخاب کنید")},a.insertCope=function(){return!a.cope.CopeName||a.cope.CopeName.length<3?void g.popError("کد سنگ خام را وارد کنید"):a.cope.Weight?a.cope.UnitPrice?a.StoneType.selected?(a.cope.StoneTypeID=a.StoneType.selected.StoneTypeID,void g.post("insertOrEditCope",a.cope).then(function(b){b&&"success"==b.Status?(g.popSuccess(b.Data),a.cope={},a.StoneType.selected=null,a.pagingController.update()):g.popError("مشکل در وارد کردن سنگ خام ، لطفا دوباره تلاش کنید.")})):void g.popError("نوع سنگ را انتخاب کنید"):void g.popError("قیمت واحد را وارد کنید"):void g.popError("وزن سنگ را وارد کنید")},a.deleteCope=function(b){g.post("deleteCope",{CopeID:b}).then(function(b){b&&"success"==b.Status?(g.popSuccess(b.Data),a.pagingController.update()):g.popError(b.Message)})},activeElement("#SCope")}]),angular.module(appName).controller("DashboardCtrl",["$scope","ADMdtpConvertor","$rootScope","Extention","$state","$timeout",function(a,b,c,d,e,f){activeElement("#SDashboard")}]),angular.module(appName).controller("PhoneCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","Extention","$uibModal",function(a,b,c,d,e,f,g,h){a.pagingParams={},a.pagingController={},a.phone={},a.search=function(){a.pagingController.update()},a.insertNewPhone=function(){return!a.phone.Username||a.phone.Username.length<3?void g.popError("نام کاربری وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.phone.pass||a.phone.pass.length<3?void g.popError("پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.phone.passRe||a.phone.passRe.length<3?void g.popError("تکرار پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):a.phone.passRe!=a.phone.pass?void g.popError("پسورد با تکرار آن برابر نیست"):void g.post("savePhone",a.phone).then(function(b){console.log(b),b&&"success"==b.Status?(g.popSuccess(b.Data),a.pagingController.update()):g.popError(b.Message)})},a.deletePhone=function(b){g.post("deletePhone",{PhoneID:b}).then(function(b){console.log(b),b&&"success"==b.Status?(g.popSuccess(b.Data),a.pagingController.update()):g.popError(b.Message)})},activeElement("#SPhone")}]),angular.module(appName).controller("ProfileCtrl",["$scope","$rootScope","$stateParams","$state","$uibModal","$timeout","Extention","Upload",function(a,b,c,d,e,f,g,h){if(a.onChangeAvatar=function(a,c){0!=a.length&&e.open({animation:!0,templateUrl:"cropModal.html",controller:["$scope","$uibModalInstance","file",function(a,c,e){if(a.croppedImage={},a.cancel=function(){c.dismiss()},null!=e){var i=new FileReader;i.onload=function(b){a.$apply(function(a){a.myImage=b.target.result})},i.readAsDataURL(e)}a.changeAvatar=function(){g.setBusy(!0);var e=function(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));return new Blob([new Uint8Array(d)],{type:c})},i=e(a.croppedImage);i.name="cropfile.png",i.upload=h.upload({url:serviceBaseURL+"updateAvatar",data:{file:i}}),a.uploading=!0,g.popInfo("لطفا تا پایان تغییر تصویر صبر کنید."),i.upload.then(function(a){f(function(){g.popSuccess("تصویر با موفقیت تغییر کرد!"),g.setBusy(!1),session.Image=a.data.Image,b.user.Image=a.data.Image,d.go("profile",{},{reload:!0}),c.dismiss()})},function(a){a.status>0?g.popError("مشکل در تغییر تصویر پروفایل"):g.popSuccess("تصویر با موفقیت تغییر کرد!"),g.setBusy(!1),d.go("profile",{},{reload:!0})},function(a){i.progress=Math.min(100,parseInt(100*a.loaded/a.total))})}}],size:"md",resolve:{file:function(){return c}}})},a.timelinePagingController={},c.action)switch(c.action){case"Sessions":a.activeTab=1;break;case"Info":a.activeTab=2}else a.activeTab=2;a.bgColorArray=["bg-aqua-active","bg-blue-active","bg-green-active","bg-yellow-active","bg-maroon-active","bg-light-blue-active","bg-green","bg-orange","bg-purple","bg-red","bg-yellow","bg-light-blue"],a.getRandomColorClass=function(b){var c=b%a.bgColorArray.length;return a.bgColorArray[c]},a.getIconClass=function(a){switch(a.EventTypeID){case"-1":return"fa-user-plus ipalette-bg-sun-flower";case"1":case"2":return"fa-star ipalette-bg-sun-flower";case"3":return"fa-check ipalette-bg-peter-river";case"4":return"fa-flask  ipalette-bg-pomegranate";case"5":return"fa-envelope  ipalette-bg-pumpkin";case"6":return"fa-user  ipalette-bg-emerald";case"7":return"fa-eye ipalette-bg-pomegranate";case"8":return"fa-hand-pointer-o ipalette-bg-alizarin";case"9":return"fa-comments ipalette-bg-amethyst";case"10":return"fa-check ipalette-bg-green-sea";case"11":return"fa-flask ipalette-bg-orange";default:return"fa-clone ipalette-bg-orange"}},a.getTab=function(b){a.activeTab=b;var c={location:!0,inherit:!0,relative:d.$current,notify:!1};switch(a.activeTab){case 1:d.transitionTo("profile",{action:"Sessions"},c);break;case 2:d.transitionTo("profile",{action:"Info"},c)}},a.isEqualWithVerify=!0,a.getUser=function(){g.post("getUserProfile").then(function(b){a.curUser=b,console.log(b)})},a.getUser(),a.getRandomSpan=function(){var a=Math.floor(6*Math.random()+1);switch(a){case 1:return"danger";case 2:return"success";case 3:return"info";case 4:return"warning";case 5:return"primary"}},a.saveUserInfo=function(){return a.curUser.Password&&a.curUser.VerifyPassword!=a.curUser.Password||a.curUser.VerifyPassword&&a.curUser.VerifyPassword!=a.curUser.Password?void g.popError("رمز وارد شده با تکرار آن یکسان نیست!"):a.curUser.Password&&a.curUser.Password.length<5?void g.popError(persianJs("رمز جدید بایستی حداقل 5 کاراکتر باشد!").englishNumber().toString()):void g.post("saveUserInfo",a.curUser).then(function(c){c&&"success"==c.Status?(g.popSuccess("با موفقیت تغییر کرد!"),session.FullName=c.FullName,b.user.FullName=c.FullName,a.curUser.Password=void 0,a.curUser.VerifyPassword=void 0,a.curUser.OldPassword=void 0):"EmailExists"==c.Message?g.popWarning("خطا : این ایمیل قبلا ثبت شده ، لطفا ایمیل دیگری انتخاب کنید.",12e3):"OldPasswordIsNotValid"==c.Message?g.popError("خطا : رمز عبور فعلی اشتباه است."):"PasswordIsNotValid"==c.Message?g.popError(persianJs("خطا : رمز عبور جدید بایستی حداقل 5 کاراکتر باشد.").englishNumber().toString()):g.popError("مشکل در تغییر اطلاعات ، لطفا دوباره تلاش کنید.")})},a.saveUserAddintionalInfo=function(){g.post("saveUserAddintionalInfo",a.curUser).then(function(a){a&&"success"==a.Status?g.popSuccess("با موفقیت تغییر کرد!"):g.popError("مشکل در تغییر اطلاعات ، لطفا دوباره تلاش کنید.")})},a.passwordChanged=function(){return a.curUser.Password||a.curUser.VerifyPassword?void(a.isEqualWithVerify=a.curUser.VerifyPassword==a.curUser.Password):void(a.isEqualWithVerify=!0)},a.randomClass=["danger","info","success","warning"],a.randomColor=function(b){return a.randomClass[b%a.randomClass.length]},a.removeSession=function(b){g.post("deleteSession",{UserSessionID:b}).then(function(b){b?"success"==b.Status?(g.popSuccess("اتصال با موفقیت قطع شد."),a.getUser()):"CurrentSession"==b.Message?g.popInfo("مشکل در قطع اتصال ، شما با این شناسه متصل هستید!"):g.popError("مشکل در قطع اتصال ، لطفا دوباره تلاش کنید."):g.popError("مشکل در قطع اتصال ، لطفا دوباره تلاش کنید.")})},activeElement("#SProfile")}]),angular.module(appName).controller("ReportingCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","$stateParams","$uibModal","Extention",function(a,b,c,d,e,f,g,h,i){a.pagingParams={Position:null},a.pagingController={},a.Machine={selected:null},a.StoneType={selected:[]},a.StoneState={selected:null},a.machines=[{Name:"ماشین A",ID:"1"},{Name:"ماشین B",ID:"2"}],a.StoneStates=[{Name:"فروخته شده",ID:"2"},{Name:"موجود",ID:"1"}],"viewStones"==b.user.AdminPermissionLevel&&(a.StoneState.selected=a.StoneStates[1]),i.postAsync("getAllStoneTypes",{}).then(function(b){a.StoneTypes=b.Data}),a.search=function(){if(a.pagingParams.MachineID=a.Machine.selected?a.Machine.selected.ID:null,a.pagingParams.StoneStateID=a.StoneState.selected?a.StoneState.selected.ID:null,a.Height&&(a.pagingParams.Height=10*Number(a.Height)),a.Width&&(a.pagingParams.Width=10*Number(a.Width)),a.Area&&(a.pagingParams.Area=1e6*a.Area),a.EndDate){var b=new Date(a.toFullEnd.unix);a.pagingParams.EndDate=b}if(a.StartDate){var c=new Date(a.toFullStart.unix);a.pagingParams.StartDate=c}if(a.StoneType.selected.length>0){a.pagingParams.StoneTypeID="("+a.StoneType.selected[0].StoneTypeID;for(var d=1;d<a.StoneType.selected.length;d++)a.pagingParams.StoneTypeID+=","+a.StoneType.selected[d].StoneTypeID;a.pagingParams.StoneTypeID+=")"}else a.pagingParams.StoneTypeID=null;a.pagingController.update()},a.getStoneImage=function(a,b){f(function(){document.getElementById("stoneImage"+a).setAttribute("src","data:image/png;base64,"+b)})},activeElement("#SReporting","#SPersonReport")}]),angular.module(appName).controller("StoneCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","$stateParams","Extention",function(a,b,c,d,e,f,g,h){a.stone=null,(a.getStoneByID=function(){h.post("getStone",{StoneID:g.id}).then(function(b){"success"==b.Status?(a.stone=b.Data,document.getElementById("stoneImage").setAttribute("src","data:image/png;base64,"+a.stone.Image),console.log(b)):(a.stone=null,console.log(b))})})()}]),angular.module(appName).controller("StoneEditCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","$stateParams","Extention",function(a,b,c,d,e,f,g,h){a.stone=null,a.Machine={selected:null},a.Direction={selected:null},a.StoneType={selected:null},a.CopeType={selected:null},a.StoneState={selected:null},a.machines=[{Name:"ماشین A",ID:"1"},{Name:"ماشین B",ID:"2"},{Name:"ماشین C",ID:"3"}],a.Directions=[{Name:"بدون بوک مچ",Value:""},{Name:"چپ",Value:"LEFT"},{Name:"راست",Value:"RIGHT"}],a.StoneStates=[{Name:"فروخته شده",ID:"2"},{Name:"موجود",ID:"1"}],(a.getStoneByID=function(){h.post("getStone",{StoneID:g.id}).then(function(b){if("success"==b.Status){b.Data.CopeNumber=Number(b.Data.CopeNumber),b.Data.Area=Number(b.Data.Area),b.Data.Width=Number(b.Data.Width),b.Data.Height=Number(b.Data.Height),a.stone=b.Data,document.getElementById("stoneImage").setAttribute("src","data:image/png;base64,"+a.stone.Image),h.postAsync("getAllStoneTypes",{}).then(function(b){a.StoneTypes=b.Data;for(var c=0;c<a.StoneTypes.length;c++)if(a.stone.StoneTypeID==a.StoneTypes[c].StoneTypeID){a.StoneType.selected=a.StoneTypes[c];break}}),h.postAsync("getAllCopeTypes",{}).then(function(b){a.copeTypes=b.Data;for(var c=0;c<a.copeTypes.length;c++)if(a.stone.CopeID==a.copeTypes[c].CopeID){a.CopeType.selected=a.copeTypes[c];break}});for(var c=0;c<a.machines.length;c++)if(a.stone.MachineNumber==a.machines[c].ID){a.Machine.selected=a.machines[c];break}for(var c=0;c<a.Directions.length;c++)if(a.stone.BockMachDirection==a.Directions[c].Value){a.Direction.selected=a.Directions[c];break}for(var c=0;c<a.StoneStates.length;c++)if(a.stone.Sold==a.StoneStates[c].ID-1){a.StoneState.selected=a.StoneStates[c];break}console.log(b)}else a.stone=null,console.log(b)})})(),a.editStone=function(){if(!a.StoneType.selected)return void h.popError("نوع سنگ را انتخاب کنید");if(!a.Machine.selected)return void h.popError("ماشین تولید کننده انتخاب نشده است");if(!a.Direction.selected)return void h.popError("جهت بوک مچ انتخاب نشده است");if(!a.CopeType.selected)return void h.popError("بلوک سنگ انتخاب نشده است");if(!a.StoneState.selected)return void h.popError("وضعیت سنگ انتخاب نشده است");a.stone.StoneTypeID=a.StoneType.selected.StoneTypeID,a.stone.MachineNumber=a.Machine.selected.ID,a.stone.CopeID=a.CopeType.selected.CopeID,a.stone.BockMachDirection=a.Direction.selected.Value,a.stone.Sold=Number(a.StoneState.selected.ID)-1;var b=a.stone;b.Image=null,b.ImageSize=null,h.post("editStone",b).then(function(a){a&&"success"==a.Status?(h.popSuccess(a.Data),d.go("stone")):(console.log(a),h.popError("مشکل در ویرایش سنگ ، لطفا دوباره تلاش کنید."))})}}]),angular.module(appName).controller("StoneTypesCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","Extention",function(a,b,c,d,e,f,g){a.pagingParams={},a.pagingController={},a.stoneType={},a.editMode=!1,a.search=function(){a.pagingController.update()},a.insertStoneType=function(){a.stoneType.Name&&a.stoneType.Name.length>2&&g.post("insertOrEditStoneType",a.stoneType).then(function(b){b&&"success"==b.Status?(g.popSuccess(b.Data),a.pagingController.update(),a.stoneType={Name:"",PreFix:""},a.editMode=!1):g.popError("مشکل در وارد کردن تگ ، لطفا دوباره تلاش کنید.")})},a.editStoneType=function(b){a.stoneType=b,a.editMode=!0},a.removeStoneType=function(b){g.post("deleteStoneType",{StoneTypeID:b}).then(function(b){b&&"success"==b.Status?(g.popSuccess("نوع سنگ با موفقیت حذف شد!"),a.search()):g.popError("مشکل در حذف نوع سنگ ، لطفا دوباره امتحان کنید.")})},activeElement("#SStoneType")}]),angular.module(appName).controller("UserCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","Extention","$uibModal",function(a,b,c,d,e,f,g,h){a.pagingParams={},a.pagingController={},a.user={},a.UserType={selected:null},g.postAsync("getAllUserTypes",{}).then(function(b){a.UserTypes=b.Data}),a.search=function(){a.pagingController.update()},a.insertNewUser=function(){return!a.user.FullName||a.user.FullName.length<3?void g.popError("نام کامل وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.Email||a.user.Email.length<3?void g.popError("ایمیل وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.Username||a.user.Username.length<3?void g.popError("نام کاربری وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.pass||a.user.pass.length<3?void g.popError("پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):!a.user.passRe||a.user.passRe.length<3?void g.popError("تکرار پسورد وارد نشده یا تعداد کاراکتر ها کم می باشد"):a.UserType.selected?a.user.passRe!=a.user.pass?void g.popError("پسورد با تکرار آن برابر نیست"):(a.user.PermissionID=a.UserType.selected.AdminPermissionID,void g.post("savePerson",a.user).then(function(b){console.log(b),b&&"success"==b.Status?(g.popSuccess(b.Data),a.user={},a.pagingController.update()):g.popError(b.Message)})):void g.popError("نوع کاربر را انتخاب کنید")},a.deleteUser=function(b){g.post("deleteUser",{UserID:b}).then(function(b){console.log(b),b&&"success"==b.Status?(g.popSuccess(b.Data),a.pagingController.update()):g.popError(b.Message)})},activeElement("#SUser")}]),angular.module(appName).controller("MainCtrl",["$scope","$rootScope","$routeParams","$state","$location","$timeout","$log","Extention","$cookies","$uibModal",function(a,b,c,d,e,f,g,h,i,j){a.bgColorArray=["bg-aqua-active","bg-purple-active","bg-red-active","bg-navy-active","bg-orange-active","bg-blue-active","bg-green-active","bg-olive-active","bg-lime-active","bg-fuchsia-active","bg-teal-active","bg-yellow-active","bg-maroon-active","bg-light-blue-active","bg-black-active","bg-green","bg-navy","bg-teal","bg-olive","bg-lime","bg-orange","bg-fuchsia","bg-purple","bg-maroon","bg-red","bg-yellow","bg-aqua","bg-blue","bg-light-blue","bg-black"],a.getRandomColorClass=function(b){var c=b%a.bgColorArray.length;return a.bgColorArray[c]}}]);